@model MyMvcApp.Models.Student
@{
    ViewData["Title"] = "Edit Student";
    var classes = ViewBag.Classes as List<MyMvcApp.Models.Classroom>;
    var sections = ViewBag.Sections as List<MyMvcApp.Models.Section>;
}

<h2>Edit Student</h2>

<form asp-action="Edit" method="post" enctype="multipart/form-data" novalidate>
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="Id" />

    <div class="mb-3">
        <label>Name</label>
        <input asp-for="Name" class="form-control"
               data-val="true"
               data-val-required="Name is required"
               data-val-regex="Only letters allowed"
               data-val-regex-pattern="^[a-zA-Z\s]+$" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label>Email</label>
        <input asp-for="Email" class="form-control"
               data-val="true"
               data-val-email="Invalid email format" />
        <span asp-validation-for="Email" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label>Roll</label>
        <input asp-for="Roll" class="form-control"
               data-val="true"
               data-val-regex="Only numbers allowed"
               data-val-regex-pattern="^[0-9]+$" />
        <span asp-validation-for="Roll" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label>Class</label>
        <select id="classSelect" name="classId" class="form-control">
            @foreach (var c in classes!)
            {
                <option value="@c.Id" selected="@(Model.ClassroomId == c.Id)">
                    @c.Name
                </option>
            }
        </select>
    </div>

    <div class="mb-3">
        <label>Section</label>
        <select id="sectionSelect" name="sectionId" class="form-control">
            @foreach (var s in sections!)
            {
                <option value="@s.Id" selected="@(Model.SectionId == s.Id)">
                    @s.Name
                </option>
            }
        </select>
    </div>

    <div class="mb-3">
        <label>Replace Photo</label>
        <input type="file" name="photo" class="form-control" accept="image/*" />
    </div>

    <h4 class="mt-4">Parent Information</h4>

    <div class="mb-3">
        <label>Guardian Name</label>
        <input asp-for="ParentInfo.FatherName" class="form-control" />
        <span asp-validation-for="ParentInfo.FatherName" class="text-danger"></span>

    </div>

    <div class="mb-3">
        <label>Phone</label>
        <input asp-for="ParentInfo.FatherPhone" class="form-control" />
        <span asp-validation-for="ParentInfo.FatherPhone" class="text-danger"></span>

    </div>

    <button class="btn btn-primary">Update</button>
    <a asp-action="Index" class="btn btn-secondary">Cancel</a>
</form>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
    <script>
        $(function () {
            $("input").on("blur", function () {
                $(this).valid();
            });
        });
    </script>
}
